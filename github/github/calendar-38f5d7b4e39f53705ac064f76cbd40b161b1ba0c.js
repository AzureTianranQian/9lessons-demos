(function(){var a;a=function(a){var b,c,d,e,f;d=a.length;if(d<1)return NaN;if(d===1)return 0;c=d3.mean(a),b=-1,e=0;while(++b<d)f=a[b]-c,e+=f*f;return e/(d-1)},$(function(){var b,c;if($(".js-calendar-graph svg").length)return;return b=$("<img />").addClass("dots").attr("src","/images/spinners/octocat-spinner-128.gif"),$(".js-calendar-graph").append(b),c=$(".js-calendar-graph").attr("data-url"),$.ajax({url:c,dataType:"json",success:function(c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;return b.remove(),z=667,h=107,F=[20,0,0,20],r=F[0],q=F[1],o=F[2],p=F[3],d=12,u=2,c||(c=[]),c=c.map(function(a){return[new Date(a[0]),a[1]]}).sort(function(a,b){return d3.ascending(a[0],b[0])}),e=3.77972616981,n=c.map(function(a){return a[1]}),v=Math.sqrt(a(n)),k=d3.mean(n),x=n.filter(function(a){var b;return b=Math.abs((k-a)/v),b>e}),x.length>0?(x=x[0],n=n.filter(function(a){return a!==x})):x=null,j=d3.max(n),s=["#d6e685","#8cc665","#44a340","#1e6823"],i=d3.scale.quantile().domain([0,j]).range(s),g=d3.time.format("%w"),E=d3.time.format("%Y%U"),D=d3.time.format("%m-%y"),l=d3.time.format("%b"),B={},m={},c.forEach(function(a){var b;return b=E(a[0]),B[b]||(B[b]=[]),B[b].push(a)}),B=d3.entries(B),B.forEach(function(a){var b;return b=D(a.value[0][0]),m[b]||(m[b]=[a.value[0][0],0]),m[b][1]+=1}),m=d3.entries(m).sort(function(a,b){return d3.ascending(a.value[0],b.value[0])}),y=d3.select(".js-calendar-graph").append("svg").attr("width",z).attr("height",h).attr("id","calendar-graph").append("g").attr("transform","translate("+p+", "+r+")"),A=0,C=y.selectAll("g.week").data(B).enter().append("g").attr("transform",function(a,b){var c;return c=a.value[0][0],c.getFullYear()===(new Date).getFullYear()&&c.getDay()!==0&&A===0&&(A=-1),"translate("+(b+A)*d+", 0)"}),t=C.selectAll("rect.day").data(function(a){return a.value}).enter().append("rect").attr("class","day").attr("width",d-u).attr("height",d-u).attr("y",function(a){return g(a[0])*d}).style("fill",function(a,b){return a[1]===0?"#eee":i(a[1])}),t.append("title").text(function(a){var b;return b=a[1]===0?"No":a[1],""+b+" "+$.pluralize(a[1],"contribution")+" on "+moment(a[0]).format("dddd MMMM Do YYYY")}),f=0,y.selectAll("text.month").data(m).enter().append("text").attr("x",function(a,b){var c;return c=d*f,f+=a.value[1],c}).attr("y",-5).attr("class","month").style("display",function(a){if(a.value[1]<=2)return"none"}).text(function(a){return l(a.value[0])}),y.selectAll("text.day").data(moment.weekdays).enter().append("text").style("display",function(a,b){if(b%2===0)return"none"}).attr("text-anchor","middle").attr("class","wday").attr("dx",-10).attr("dy",function(a,b){return r+((b-1)*d+u)}).text(function(a){return a[0]}),w=[0].concat(i.quantiles().map(Math.round)).concat([d3.max([x,j])]),w=w.map(function(a,b){return b===0?"No contributions":w[b-1]+1===a?""+a+" contributions":"Between "+(w[b-1]+1)+" and "+a+" contributions"}),d3.selectAll(".legend li").data(w).attr("title",function(a){return a})}})})}).call(this);